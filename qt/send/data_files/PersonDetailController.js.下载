var personDetailCtrl = angular.module('dc.controller.personQuery.personDetailCtrl', []);	
personDetailCtrl.controller("personDetailController",['$scope','$routeParams','$http',function($scope,$routeParams,$http){
	$scope.errorMsg = "";
	$scope.infomationItems=null;
	$scope.seqNo = $routeParams.seqNo;	
	$scope.random = null;
	$scope.showDetail = function(){
		$http({
	    	method:'GET',
	        dataType: "json",
	        contentType:'application/json; charset=UTF-8',
	        url:'/publicQuery/ctrl/common/personQuery/showDetail.do',
	        params:{
	        	seqNo:$scope.seqNo
	        }
	    }).success(function(response){
	       	if(response.success==true){
	        	setTimeout(function(){
	        		$scope.infomationItems = response.items;
	            	$scope.$apply();
	            },200);	
	        }else{
	        	$scope.person = null;
	        	$scope.errorMsg=response.msg;
	        }
	    }).error(function(){
	        $scope.errorMsg="服务器没有响应";
	    });
	};
	
	$scope.refreshCellHeight = function () {
		if($(window).width()>800){
			var iLen = $(".border-table-cell").length;
			var maxH=50;
			for(var j=0;j<iLen;j++){
				if(j%3==0)
					maxH=50;
				if($(".border-table-cell:eq("+j+")").height()>maxH)
					maxH = $(".border-table-cell:eq("+j+")").height();
				if(maxH>50 && (j%3==2 || j==iLen-1) ){
					if(j%3==2){
						$(".border-table-cell:eq("+(j-2)+") span:eq(0)").height(maxH-12);
						$(".border-table-cell:eq("+(j-1)+") span:eq(0)").height(maxH-12);
						$(".border-table-cell:eq("+j+") span:eq(0)").height(maxH-12);
					}else if(j==iLen-1){
							if(j%3==1){
								$(".border-table-cell:eq("+(j-1)+") span:eq(0)").height(maxH-12);
								$(".border-table-cell:eq("+j+") span:eq(0)").height(maxH-12);
							}
							else if(j%3==0){
								$(".border-table-cell:eq("+j+") span:eq(0)").height(maxH-12);
							}
						}
					}
				}
			
		}
	};
	
	window.onresize = function () {
		$scope.refreshCellHeight();
	};
	
    //初始化函数
    var init = function() {
    	$scope.random = Math.random();
    	$scope.showDetail();
    	setTimeout(function(){
    		$scope.refreshCellHeight();
    	},1000);	
    };
    init();
}]);