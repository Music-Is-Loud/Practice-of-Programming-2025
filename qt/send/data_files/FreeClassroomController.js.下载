var freeClassroomCtrl = angular.module('dc.controller.freeClassroom.freeClassroomCtrl', []);	
freeClassroomCtrl.controller("freeClassroomController",['$scope','$http',function($scope,$http){
	$scope.building = "一教";
	$scope.time = "今天";
	$scope.classrooms = [];
		
	$scope.gotoDIV = function(div){
		var offsetTop=$("#"+div).offset();
		var offset = offsetTop.top;
		$("html,body").animate({scrollTop:offset},100); 
	};
		
	$scope.changeBuilding = function(event,value,id){
		if($scope.building!==value){
			$scope.building = value;
			for(var index=1;index<=10;index++){
				if(index==parseInt(id)){
					$("#"+index).css("background-color","#8c0000");
		            $("#"+index+"a").css("color","#ffffff");   
		        }else{  
		            $("#"+index).css("background-color","transparent");
		            $("#"+index+"a").css("color","#000000");     
		        }
			}
			$scope.retrClassRoomFree();
		}
	};
		
	$scope.changeTime = function(element,value,id){
		if($scope.time!==value){
			$scope.time = value;
			for(var index=11;index<=13;index++){
				if(index==parseInt(id)){   
					$("#"+index).css("background-color","#8c0000");
		            $("#"+index+"a").css("color","#ffffff");   
		        }else{  
		            $("#"+index).css("background-color","transparent");
		            $("#"+index+"a").css("color","#000000");
		        }
			}
			$scope.retrClassRoomFree();
		}	
	};
		
	$scope.retrClassRoomFree = function(){
		$http({
	    	method:'GET',
	        dataType: "json",
	        contentType:'application/json; charset=UTF-8',
	        url:'/publicQuery/classroomQuery/retrClassRoomFree.do',
	        params:{
	        	buildingName : $scope.building,
	            time : $scope.time
	        }
	    }).success(function(response){
	    	$scope.classrooms = response.rows;
	    }).error(function(e, code){
	       	throw(code);
	    });
	};
		
    //初始化函数
    var init = function() {
    	$scope.retrClassRoomFree();
    };
    init();
}]);