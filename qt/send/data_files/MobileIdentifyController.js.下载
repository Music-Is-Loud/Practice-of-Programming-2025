var mobileIdentifyCtrl = angular.module('dc.controller.mobileIdentify.mobileIdentifyCtrl', []);	
mobileIdentifyCtrl.controller("mobileIdentifyController",['$scope','$http',function($scope,$http){
	$scope.keyWord=null;
	$scope.errMsg=null;
	$scope.persons = [];
	
	$scope.changeKeyword = function(){
		if($scope.keyWord==null || $scope.keyWord=="")
			$("#clear_btn").hide();
		else
			$("#clear_btn").show();
	};
	
	$scope.search = function(){
		if($scope.keyWord!=null && $scope.keyWord!=""){
			$http({
	            method:'GET',
	            dataType: "json",
	            contentType:'application/json; charset=UTF-8',
	            url:'/publicQuery/ctrl/common/mobileIdentify/query.do',
	            params:{mobile:$scope.keyWord}
	        }).success(function(response){
	        	if(response.success==true){
	        		$scope.persons = response.rows;
	        		$scope.errMsg="";
	        		if($scope.persons==null || $scope.persons.length==0)
	        			$scope.errMsg="尚未找到任何符合条件的人员";
	        	}
	        	else{
	        		$scope.persons = [];
	        		$scope.errMsg=response.errMsg;
	        	}
	        }).error(function(){
	        	$scope.errMsg="服务器异常，请重试";
	        });
		}
	};
	
	$scope.enterKeyword = function(e){
		if(e.keyCode==13){
			$scope.keyWord = $("#keyword").val();
			$scope.search();
		}else
			$("#clear_btn").show();
	};
	
	$scope.clear = function(e){
		$scope.keyWord=null;
		$scope.errMsg=null;
		$("#clear_btn").hide();
		$("#keyword").select();
	};
}]);